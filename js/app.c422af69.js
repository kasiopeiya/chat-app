(function(t){function e(e){for(var o,r,n=e[0],c=e[1],l=e[2],m=0,d=[];m<n.length;m++)r=n[m],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var t,e=0;e<i.length;e++){for(var s=i[e],o=!0,n=1;n<s.length;n++){var c=s[n];0!==a[c]&&(o=!1)}o&&(i.splice(e--,1),t=r(r.s=s[0]))}return t}var o={},a={app:0},i=[];function r(e){if(o[e])return o[e].exports;var s=o[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=o,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(s,o,function(e){return t[e]}.bind(null,o));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=e,n=n.slice();for(var l=0;l<n.length;l++)e(n[l]);var u=c;i.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var o=s("85ec"),a=s.n(o);a.a},"0602":function(t,e,s){"use strict";var o=s("7582"),a=s.n(o);a.a},"1ac2":function(t,e,s){"use strict";var o=s("45b4"),a=s.n(o);a.a},"1ba7":function(t,e,s){},3564:function(t,e,s){"use strict";var o=s("6d1b"),a=s.n(o);a.a},"45b4":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var o=s("2b0e"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("headerComp"),s("router-view")],1)},i=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",[s("h1",[t._v("Otter chat")]),s("div",{staticClass:"singOut",on:{click:t.signOut}},[t._v("サインアウト")])])},n=[],c=s("b752"),l=s.n(c),u={name:"headerComp",props:{},data:function(){return{}},methods:{signOut:function(){var t=this;l.a.auth().signOut().then((function(){t.$router.push("/")}))}}},m=u,d=(s("c490"),s("2877")),p=Object(d["a"])(m,r,n,!1,null,"3d5091f8",null),h=p.exports,f={name:"App",components:{headerComp:h},created:function(){this.$router.push({path:"/"})}},v=f,g=(s("034f"),Object(d["a"])(v,a,i,!1,null,null,null)),b=g.exports,_=s("5f2b"),y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container mt-5"},[s("h2",[t._v("ログイン画面")]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.signIn(e)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("メールアドレス：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",id:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{type:"password"}},[t._v("パスワード：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),s("button",{staticClass:"btn btn-info",attrs:{type:"submit"}},[t._v("ログイン")])]),s("p",[t._v(" 既にアカウントを持っていますか？ "),s("br"),s("router-link",{attrs:{to:"/signUp"}},[t._v("サインアップはこちら")])],1)])])])},w=[],R={name:"signIn",props:[],data:function(){return{email:"",password:"",isAuthenticated:!1}},methods:{signIn:function(){var t=this;l.a.auth().signInWithEmailAndPassword(this.email,this.password).then((function(e){t.$router.push({path:"/room",query:{userId:e.user.uid,loginUser:e.user.displayName,profileImg:e.user.photoURL}})})).catch((function(t){alert(t.message)}))}}},C=R,x=Object(d["a"])(C,y,w,!1,null,"3ac08cd1",null),I=x.exports,M=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container mt-5"},[s("h2",[t._v("新規登録")]),s("br"),s("span",{staticClass:"errorMsg"},[t._v(t._s(t.errorMsg))]),s("br"),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.signUp(e)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"displayName"}},[t._v("ニックネーム：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text",placeholder:"ちゃん・かわうそ"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("メールアドレス：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",id:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{type:"password"}},[t._v("パスワード：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{type:"password"}},[t._v("パスワード(確認)：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password2,expression:"password2"}],staticClass:"form-control",attrs:{type:"password",id:"password"},domProps:{value:t.password2},on:{input:function(e){e.target.composing||(t.password2=e.target.value)}}})]),s("button",{staticClass:"btn btn-info",attrs:{type:"submit"}},[t._v("登録")])]),s("p",[s("router-link",{attrs:{to:"/"}},[t._v("サインインはこちら")])],1)])])])},k=[],O={name:"singUp",props:[],data:function(){return{email:"",password:"",password2:"",username:"",isAuthenticated:!1,errorMsg:""}},mounted:function(){this.errorMsg=""},methods:{signUp:function(){var t=this;this.checkForm()&&l.a.auth().createUserWithEmailAndPassword(this.email,this.password).then((function(e){e.user.updateProfile({displayName:t.username,photoURL:s("bf63")}),alert("アカウントを作成しました"),t.$router.push("/")})).catch((function(e){t.errorMsg="システムエラー：".concat(e.message)}))},checkForm:function(){return this.username.length<2?(this.errorMsg="名前は2文字以上で入力してください",!1):""!==this.email&&(this.password.length<6?(this.errorMsg="パスワードは6文字以上で入力してください",!1):this.password===this.password2||(this.errorMsg="パスワードが一致しません",!1))}}},N=O,P=(s("0602"),Object(d["a"])(N,M,k,!1,null,"ad062f72",null)),F=P.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatTop"},[s("div",{staticClass:"chatContainer"},[s("aside",[s("div",{staticClass:"aside-head"},[s("h2",[t._v("Rooms")]),s("p",[s("span",{attrs:{id:"mark"}},[t._v("●")]),t._v(" "+t._s(t.loginUser)+"さん ")])]),t._m(0)]),s("main",{staticClass:"chat"},[s("message",{attrs:{chatLists:this.chatLists}}),s("textForm",{on:{submit:t.postMessage}})],1)]),s("footer",[s("div",{staticClass:"chatFooter",on:{click:t.sendToRoom}},[t._v("Room一覧に戻る")])])])},K=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"aside-body"},[s("section",[s("div")])])}],L=(s("4160"),s("159b"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},t._l(t.chatLists,(function(e,o){return s("div",{key:e.id},[s("ul",{staticClass:"messages"},[s("li",{class:{rightSide:o%2===1,leftSide:o%2===0}},[s("div",[s("div",{staticClass:"head"},[t._v(t._s(e.name))]),s("div",{staticClass:"body"},[s("div",{staticClass:"pic"},[s("img",{attrs:{src:e.img}})]),s("div",{staticClass:"contents"},[s("div",{staticClass:"text"},[t._v(t._s(e.message))]),s("div",{staticClass:"date"},[t._v(t._s(e.date))])])])])])])])})),0)}),U=[],T={name:"message",props:["chatLists"]},D=T,j=(s("6fdb"),Object(d["a"])(D,L,U,!1,null,"36d26412",null)),E=j.exports,S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form"},[t.input.length>200?[s("span",{staticClass:"alertMsg"},[t._v("文字数が200文字を超えています。")])]:t._e(),t._v(" "+t._s(t.input.length)+"文字 "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],attrs:{id:"textarea"},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}}),s("button",{class:{btn:!0,inactive:t.input.length>200||0===t.input.length},on:{click:function(e){return t.$emit("submit",t.input)}}},[t._v("送信")])],2)},q=[],A={name:"textForm",props:{},data:function(){return{input:""}}},B=A,V=(s("3564"),Object(d["a"])(B,S,q,!1,null,"3a7fad52",null)),H=V.exports,Q=(s("fb6a"),{methods:{getCurrentDate:function(){var t=new Date,e=t.getFullYear(),s=("00"+(t.getMonth()+1)).slice(-2),o=("00"+t.getDate()).slice(-2),a=("00"+t.getHours()).slice(-2),i=("00"+t.getMinutes()).slice(-2),r=("00"+t.getSeconds()).slice(-2);return e+"/"+s+"/"+o+" "+a+":"+i+":"+r},getRandomString:function(){for(var t=8,e="abcdefghijklmnopqrstuvwxyz0123456789",s=e.length,o="",a=0;a<t;a++)o+=e[Math.floor(Math.random()*s)];return o},getLen:function(t){for(var e=0,s=0;s<t.length;s++){var o=t.charCodeAt(s);e+=o>=0&&o<129||63728===o||o>=65377&&o<65440||o>=63729&&o<63732?1:2}return e}}}),z={name:"chat",props:[],components:{message:E,textForm:H},data:function(){return{chatLists:[],loginUser:this.$route.query.loginUser,profileImg:this.$route.query.profileImg,roomId:this.$route.query.roomId,tableName:"chat_"+this.$route.query.roomId}},mixins:[Q],mounted:function(){var t=this;this.getMessagesFromDB(),setTimeout((function(){t.scrollBottom()}),600)},methods:{postMessage:function(t){t.length>200||0===t.length||(this.sendMessageToDB(t),this.getMessagesFromDB(),this.updateDate(),this.scrollBottom())},sendMessageToDB:function(t){var e=this.getRandomString()+(this.chatLists.length+1),s=this.loginUser,o=this.profileImg,a={id:e,name:s,img:o,message:t,date:this.getCurrentDate()};l.a.firestore().collection("rooms").doc(this.roomId).collection("chat").doc(e).set({message:a}).then((function(t){console.log("".concat(t.id," added!"))})).catch((function(t){console.log(t)}))},getMessagesFromDB:function(){var t=this,e=[];l.a.firestore().collection("rooms").doc(this.roomId).collection("chat").onSnapshot((function(t){t.docChanges().forEach((function(t){var s=t.doc.data();e.push(s.message)}))})),setTimeout((function(){t.chatLists=e.sort((function(t,e){return t.date<e.date?-1:1}))}),800)},scrollBottom:function(){setTimeout((function(){window.scrollTo(0,document.querySelector(".chat").clientHeight)}),300)},updateDate:function(){var t=this;l.a.firestore().collection("rooms").doc(this.roomId).update({last_modified:this.getCurrentDate()}).then((function(){console.log("".concat(t.inputRoomName,"roomを更新しました"))})).catch((function(t){console.log(t)}))},sendToRoom:function(){this.$router.push({path:"/room",query:{userId:this.$route.query.userId,loginUser:this.$route.query.loginUser,profileImg:this.$route.query.profileImg}})}}},J=z,W=(s("1ac2"),Object(d["a"])(J,$,K,!1,null,"0c582778",null)),G=W.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"roomVue"},[s("div",{staticClass:"rooms"},[s("aside",[s("div",{staticClass:"aside-head"},[s("h2",[t._v("Rooms")]),s("p",[s("span",{attrs:{id:"mark"}},[t._v("●")]),t._v(" "+t._s(t.loginUser)+"さん ")])]),s("div",{staticClass:"aside-body"},[s("section",t._l(t.menuList,(function(e,o){return s("div",{key:e.number,class:{clicked:t.activeItem===o},on:{click:function(e){t.activeItem=o}}},[t._v(t._s(e.name))])})),0)])]),s("main",[s("div",{staticClass:"main-head"},[""!==t.activeItem?[s("h2",[t._v(t._s(t.menuList[t.activeItem].name))]),s("div",[s("b-form-group",[s("b-form-radio-group",{attrs:{id:"btn-radios-1",options:t.options,buttons:"",name:"radios-btn-default"},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)],1)]:t._e()],2),s("div",{staticClass:"main-body"},[s("roomCreation",{directives:[{name:"show",rawName:"v-show",value:0==t.activeItem,expression:"activeItem == 0"}],attrs:{errorMsg:this.errorMsg,loginUser:this.loginUser,userId:this.userId}}),s("roomList",{directives:[{name:"show",rawName:"v-show",value:1==t.activeItem,expression:"activeItem == 1"}],attrs:{filteredRooms:this.filteredRooms},on:{enterRoom:t.enterRoom,chageFavorites:t.chageFavorites}}),s("myRoom",{directives:[{name:"show",rawName:"v-show",value:2==t.activeItem,expression:"activeItem == 2"}],attrs:{filteredRooms:this.filteredRooms,userId:this.userId},on:{enterRoom:t.enterRoom,chageFavorites:t.chageFavorites,deleteRoom:t.deleteRoom}}),s("favRoom",{directives:[{name:"show",rawName:"v-show",value:3==t.activeItem,expression:"activeItem == 3"}],attrs:{filteredRooms:this.filteredRooms},on:{enterRoom:t.enterRoom,chageFavorites:t.chageFavorites}}),s("section",{directives:[{name:"show",rawName:"v-show",value:4==t.activeItem,expression:"activeItem == 4"}],staticClass:"chatbot"},[s("chatbot",{attrs:{loginUser:t.loginUser,profileImg:t.profileImg}})],1),s("section",{class:{hidden:!t.isOpenModal},attrs:{id:"modal"}},[s("form",{on:{submit:function(e){return e.preventDefault(),t.enterRoomForPrivateChat(e)}}},[s("div",{staticClass:"form-group"},[s("div",{directives:[{name:"show",rawName:"v-show",value:""!==this.errorMsg,expression:"this.errorMsg !== ''"}],staticStyle:{color:"red"}},[t._v(t._s(t.errorMsg))]),s("label",{attrs:{type:"password"}},[t._v("ルームキーを入力してください：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputKey,expression:"inputKey"}],ref:"focusThis",staticClass:"form-control",attrs:{type:"password",id:"password"},domProps:{value:t.inputKey},on:{input:function(e){e.target.composing||(t.inputKey=e.target.value)}}})])]),s("div",{attrs:{id:"close"},on:{click:function(e){t.isOpenModal=!t.isOpenModal}}},[t._v("閉じる")])]),s("div",{class:{hidden:!t.isOpenModal},attrs:{id:"mask"}})],1)])]),s("footer")])},Y=[],Z=(s("4de4"),s("caad"),s("d81d"),s("d3b7"),s("2532"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("message",{attrs:{chatLists:this.chatLists}}),s("textForm",{on:{submit:t.postMessage}})],1)}),tt=[],et=(s("c975"),s("b0c0"),s("4ec9"),s("3ca3"),s("ddb0"),{name:"chat",props:["loginUser","profileImg"],components:{message:E,textForm:H},data:function(){return{chatLists:[{id:"0001",name:"chang-kawauso",img:s("95ed"),message:"ん、何？質問？聞くよ！！！",date:this.getCurrentDate()}],replyMsgMap:new Map}},mixins:[Q],mounted:function(){this.replyMsgMap.set("うんこ","くさいくさい、うんこくさい！！！"),this.replyMsgMap.set("考え方","やっぱりさー、考え方の問題だよねー"),this.replyMsgMap.set("かわうそ","僕は二ホンカワウソです"),this.replyMsgMap.set("kick","ちゃん・かわうそ、キー！！！"),this.replyMsgMap.set("なかじま","なかじまってさー、使えないよねー"),this.replyMsgMap.set("kimochi","わかるわかる、よくわかるその気持ち")},methods:{postMessage:function(t){var e=this;if(!(t.length>200||0===t.length)){var s=this.chatLists.length+1,o=this.loginUser,a=this.profileImg;this.chatLists.push({id:s,name:o,img:a,message:t,date:this.getCurrentDate()}),setTimeout((function(){e.scrollBottom()}),800)}},replyMsg:function(t){var e=this.chatLists.length+1,o="chang-kawauso",a=this.replyMsgMap.get(t);this.chatLists.push({id:e,name:o,img:s("95ed"),message:a,date:this.getCurrentDate()}),this.scrollBottom()},scrollBottom:function(){window.scrollTo(0,document.body.clientHeight)}},watch:{chatLists:function(){var t=this,e=this.chatLists[this.chatLists.length-1].message,s=this.chatLists[this.chatLists.length-1].name;"chang-kawauso"!==s&&(setTimeout((function(){-1==e.indexOf("きらい")&&-1==e.indexOf("カス")&&-1==e.indexOf("うざい")?-1==e.indexOf("うんこ")&&-1==e.indexOf("unko")&&-1==e.indexOf("ぶりぶり")?-1==e.indexOf("かわうそ")&&-1==e.indexOf("カワウソ")&&-1==e.indexOf("kawauso")&&-1==e.indexOf("皮嘘")?-1==e.indexOf("chang")&&-1==e.indexOf("ちゃん")?-1==e.indexOf("犬")&&-1==e.indexOf("なかじま")?t.replyMsg("kimochi"):t.replyMsg("なかじま"):t.replyMsg("kick"):t.replyMsg("かわうそ"):t.replyMsg("うんこ"):t.replyMsg("考え方")}),2e3),setTimeout((function(){t.scrollBottom()}),2800))}}}),st=et,ot=Object(d["a"])(st,Z,tt,!1,null,null,null),at=ot.exports,it=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("b-list-group",t._l(t.filteredRooms,(function(e){return s("b-list-group-item",{key:e.roomId,staticClass:"flex-column align-items-start",attrs:{href:"#",id:"b-list"},on:{click:function(s){return t.$emit("enterRoom",e)}}},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-1"},[t._v(" "+t._s(e.roomName)+" "),""===e.roomKey?[s("b-badge",{attrs:{variant:"dark",pill:""}},[t._v("OPEN")])]:[s("b-badge",{attrs:{variant:"success",pill:""}},[t._v("PRIVATE")]),s("b-icon",{attrs:{icon:"lock-fill"}})]],2),s("span",{staticClass:"text-muted h5"},[s("span",{staticClass:"right-space"},[!0===e.addFlg?[t._v("remove")]:[t._v("add")]],2),s("b-icon",{class:{added:!0===e.addFlg},attrs:{icon:"star-fill"},on:{click:function(s){return s.preventDefault(),t.$emit("chageFavorites",arguments[0],e)}}})],1)]),s("p",{staticClass:"mb-1"},[t._v(t._s(e.contents))]),s("small",{staticClass:"text-muted"},[s("span",{staticClass:"right-space"},[t._v("founder: "+t._s(e.founder))]),s("span",{staticClass:"right-space"},[t._v("from: "+t._s(e.creation_date))]),s("span",[t._v("Last Modified: "+t._s(e.last_modified))])])])})),1)],1)},rt=[],nt={name:"roomLIst",props:["filteredRooms"]},ct=nt,lt=Object(d["a"])(ct,it,rt,!1,null,"12cdbbdd",null),ut=lt.exports,mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("b-list-group",[t._l(t.filteredRooms,(function(e){return[e.founderUID===t.userId?[s("b-list-group-item",{key:e.roomId,staticClass:"flex-column align-items-start",attrs:{href:"#",id:"b-list"},on:{click:function(s){return t.$emit("enterRoom",e)}}},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-1"},[t._v(" "+t._s(e.roomName)+" "),""===e.roomKey?[s("b-badge",{attrs:{variant:"dark",pill:""}},[t._v("OPEN")])]:[s("b-badge",{attrs:{variant:"success",pill:""}},[t._v("PRIVATE")]),s("b-icon",{attrs:{icon:"lock-fill"}})]],2),s("span",{staticClass:"text-muted h5"},[s("span",{staticClass:"right-space"},[!0===e.addFlg?[t._v("remove")]:[t._v("add")]],2),s("b-icon",{class:{added:!0===e.addFlg,"right-space2":!0},attrs:{icon:"star-fill"},on:{click:function(s){return s.preventDefault(),t.$emit("chageFavorites",arguments[0],e)}}}),s("b-icon",{attrs:{icon:"trash"},on:{click:function(s){return s.preventDefault(),t.$emit("deleteRoom",arguments[0],e)}}})],1)]),s("p",{staticClass:"mb-1"},[t._v(t._s(e.contents))]),s("small",{staticClass:"text-muted"},[s("span",{staticClass:"right-space"},[t._v("founder: "+t._s(e.founder))]),s("span",{staticClass:"right-space"},[t._v("from: "+t._s(e.creation_date))]),s("span",[t._v("Last Modified: "+t._s(e.last_modified))])])])]:t._e()]}))],2)],1)},dt=[],pt={name:"myRoom",props:["filteredRooms","userId"]},ht=pt,ft=Object(d["a"])(ht,mt,dt,!1,null,"45a21292",null),vt=ft.exports,gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("b-list-group",[t._l(t.filteredRooms,(function(e){return[!0===e.addFlg?[s("b-list-group-item",{key:e.roomId,class:{"flex-column":!0,"align-items-start":!0,isDeleted:!0===e.isDeleted},attrs:{href:"#",id:"b-list"},on:{click:function(s){return t.$emit("enterRoom",e)}}},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-1"},[t._v(" "+t._s(e.roomName)+" "),""===e.roomKey?[s("b-badge",{attrs:{variant:"dark",pill:""}},[t._v("OPEN CHAT")])]:[s("b-badge",{attrs:{variant:"success",pill:""}},[t._v("PRIVATE CHAT")]),s("b-icon",{attrs:{icon:"lock-fill"}})]],2),s("span",{staticClass:"text-muted h5"},[s("span",{staticClass:"right-space"},[!0===e.addFlg?[t._v("remove")]:[t._v("add")]],2),s("b-icon",{class:{added:!0===e.addFlg},attrs:{icon:"star-fill"},on:{click:function(s){return s.preventDefault(),t.$emit("chageFavorites",arguments[0],e)}}})],1)]),s("p",{staticClass:"mb-1"},[t._v(t._s(e.contents))]),s("small",{staticClass:"text-muted"},[s("span",{staticClass:"right-space"},[t._v("founder: "+t._s(e.founder))]),s("span",{staticClass:"right-space"},[t._v("from: "+t._s(e.creation_date))]),s("span",[t._v("Last Modified: "+t._s(e.last_modified))])])])]:t._e()]}))],2)],1)},bt=[],_t={name:"favRoom",props:["filteredRooms"]},yt=_t,wt=Object(d["a"])(yt,gt,bt,!1,null,"2815d2ce",null),Rt=wt.exports,Ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{attrs:{id:"RoomForm"}},[s("form",{on:{submit:function(e){return e.preventDefault(),t.createRoom(e)}}},[s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:""!==t.errorMsg,expression:"errorMsg !== ''"}],staticStyle:{color:"red"}},[t._v(t._s(t.errorMsg))]),s("label",{attrs:{type:"text"}},[t._v("*Room Name：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputRoomName,expression:"inputRoomName"}],staticClass:"form-control",attrs:{type:"text",id:"text"},domProps:{value:t.inputRoomName},on:{input:function(e){e.target.composing||(t.inputRoomName=e.target.value)}}}),s("br"),s("br"),s("p",[t._v("Private or Open ?：")]),s("label",[s("p",{staticStyle:{display:"inline-block",width:"100px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.isPrivateRoom,expression:"isPrivateRoom"}],attrs:{type:"radio",value:"true"},domProps:{checked:t._q(t.isPrivateRoom,"true")},on:{change:function(e){t.isPrivateRoom="true"}}}),t._v(":Private ")])]),s("label",[s("p",{staticStyle:{display:"inline-block"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.isPrivateRoom,expression:"isPrivateRoom"}],attrs:{type:"radio",value:"false"},domProps:{checked:t._q(t.isPrivateRoom,"false")},on:{change:function(e){t.isPrivateRoom="false"}}}),t._v(":Open ")])]),s("br"),s("label",{attrs:{type:"text"}},[t._v("*Room Key：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputRoomKey,expression:"inputRoomKey"}],staticClass:"form-control",attrs:{type:"password",disabled:"false"===t.isPrivateRoom},domProps:{value:t.inputRoomKey},on:{input:function(e){e.target.composing||(t.inputRoomKey=e.target.value)}}}),s("br"),s("br"),s("label",{attrs:{type:"textarea"}},[t._v("introduction(max 200 characters)：")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.contents.length<=200,expression:"contents.length <= 200"}],staticClass:"left-space"},[t._v(t._s(t.contents.length)+"characters")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contents,expression:"contents"}],staticClass:"form-control introduction",attrs:{type:"textarea",maxlength:"200",rows:"3"},domProps:{value:t.contents},on:{input:function(e){e.target.composing||(t.contents=e.target.value)}}})]),s("br"),s("button",{staticClass:"btn btn-info",attrs:{type:"submit"}},[t._v("作成")])])])},xt=[],It={name:"roomCreation",mixins:[Q],props:["errorMsg","loginUser","userId"],data:function(){return{isPrivateRoom:!0,inputRoomName:"",inputRoomKey:"",contents:""}},methods:{createRoom:function(){var t=this;if(this.errorMsg="",this.checkRoomForm()){var e=this.getRandomString();0===this.getLen(this.contents)&&(this.contents="".concat(this.inputRoomName,"の部屋です。よろしくお願いします。")),l.a.firestore().collection("rooms").doc(e).set({contents:this.contents,roomName:this.inputRoomName,roomId:e,roomKey:this.inputRoomKey,founder:this.loginUser,founderUID:this.userId,creation_date:this.getCurrentDate(),last_modified:this.getCurrentDate()}).then((function(){alert("".concat(t.inputRoomName,"roomを作成しました"))})).catch((function(t){console.log(t)})),this.inputRoomKey="",this.isPrivateRoom=!0,this.contents="",this.inputRoomName=""}},checkRoomForm:function(){return""===this.inputRoomName?(this.errorMsg="RoomNameが入力されていません",!1):this.getLen(this.inputRoomName)>40?(this.errorMsg="RoomNameは40文字以下で入力してください",!1):!0===this.isPrivateRoom&&String(this.inputRoomKey).length<4?(this.errorMsg="4文字以上のRoomKeyを入力してください",!1):this.getLen(this.inputRoomKey)>20?(this.errorMsg="inputRoomKeyは20文字以下で設定してください",!1):!(this.getLen(this.contents)>200)||(this.errorMsg="introductionは200文字以下で入力してください",!1)}}},Mt=It,kt=Object(d["a"])(Mt,Ct,xt,!1,null,"0776c333",null),Ot=kt.exports,Nt={name:"room",props:[],components:{chatbot:at,roomList:ut,myRoom:vt,favRoom:Rt,roomCreation:Ot},data:function(){return{rooms:[],fav_rooms:[],menuList:[{number:0,name:"Room作成"},{number:1,name:"Room一覧"},{number:2,name:"My Room"},{number:3,name:"Favorites"},{number:4,name:"Question To Chang"}],isOpenModal:!1,inputKey:"",roomKey:"",errorMsg:"",loginUser:this.$route.query.loginUser,currentRoom:"",activeItem:1,userId:this.$route.query.userId,profileImg:this.$route.query.profileImg,fav_roomIds:"",options:[{text:"All",value:0},{text:"Private",value:1},{text:"Open",value:2}],selected:[0],boforeSortRooms:[]}},mixins:[Q],created:function(){this.isOpenModal=!1,this.roomKey="",this.errorMsg="",this.getRoom()},methods:{getRoom:function(){var t=this,e=[],s=new Promise((function(t){l.a.firestore().collection("rooms").orderBy("last_modified").onSnapshot((function(t){t.docChanges().forEach((function(t){if("added"===t.type){var s=t.doc.data();s.addFlg=!1,e.push(s),console.log("room取得しました")}}))})),t()}));s.then((function(){setTimeout((function(){t.rooms=e.sort((function(t,e){return t.last_modified<e.last_modified?1:-1})),console.log("ソートしました"),console.log(t.rooms)}),500)}))},setFavRooms:function(){var t=this,e=[];l.a.firestore().collection("favorites").doc(this.userId).get().then((function(s){s.exists?(e=s.data().fav_roomIds,console.log("fav_roomIds取得成功"),console.log(e),t.fav_roomIds=e):console.log("fav_roomsが１つもありません")})).catch((function(t){console.log(t.message)})),setTimeout((function(){t.rooms.forEach((function(e){t.fav_roomIds.includes(e.roomId)&&(e.addFlg=!0)})),console.log("お気に入りroomセット完了")}),500)},enterRoom:function(t){if(""===t.roomKey)return this.currentRoom=t,void this.sendToChat(t);this.openModal(t)},sendToChat:function(){this.$router.push({path:"/chat",query:{userId:this.userId,loginUser:this.loginUser,profileImg:this.profileImg,roomId:this.currentRoom.roomId}})},enterRoomForPrivateChat:function(){var t=this,e=new Promise((function(e){t.errorMsg="",e()}));e.then((function(){""===t.roomKey||t.checkRoomKey()?t.sendToChat():setTimeout((function(){t.errorMsg="ルームキーが違います"}),600)}))},checkRoomKey:function(){return this.inputKey===this.roomKey&&(this.roomKey="",!0)},openModal:function(t){this.currentRoom=t,this.roomKey=t.roomKey,this.errorMsg="",""!==this.roomKey?(this.isOpenModal=!this.isOpenModal,this.$refs.focusThis.focus(),this.scrollUp()):alert("system error")},scrollUp:function(){window.scrollTo(0,0)},chageFavorites:function(t,e){t.stopPropagation(),e.addFlg=!e.addFlg,this.updateFavorites()},updateFavorites:function(){var t=[];t=this.rooms.filter((function(t){return!0===t.addFlg})),this.fav_roomIds=t.map((function(t){return t.roomId})),l.a.firestore().collection("favorites").doc(this.userId).set({fav_roomIds:this.fav_roomIds,uid:this.userId,useName:this.loginUser}).then((function(){console.log("update favorites!")})).catch((function(t){console.log(t)}))},deleteRoom:function(t,e){t.stopPropagation(),window.confirm("".concat(e.roomName,"を削除してもよろしいですか？"))&&(l.a.firestore().collection("rooms").doc(e.roomId).delete().then((function(){console.log("".concat(e.roomName," delteed!"))})).catch((function(t){console.log(t)})),this.getRoom(),this.setFavRooms())}},watch:{rooms:function(){var t=this;this.setFavRooms(),setTimeout((function(){t.selected=0}),900)}},computed:{filteredRooms:function(){var t=[];return 0===this.selected?this.rooms:(1===this.selected&&this.rooms.forEach((function(e){""!==e.roomKey&&t.push(e)})),2===this.selected&&this.rooms.forEach((function(e){""===e.roomKey&&t.push(e)})),t)}}},Pt=Nt,Ft=(s("7dde"),Object(d["a"])(Pt,X,Y,!1,null,null,null)),$t=Ft.exports;o["default"].use(_["a"]);var Kt=new _["a"]({mode:"history",routes:[{path:"/signUp",name:"signUp",component:F},{path:"/",name:"signIn",component:I},{path:"/chat",name:"chat",component:G,meta:{requiresAuth:!0}},{path:"/room",name:"room",component:$t,meta:{requiresAuth:!0}}]}),Lt=Kt,Ut=s("5f5b"),Tt=s("b1e0");s("f9e3"),s("2dd8");o["default"].use(Ut["a"]),o["default"].use(Tt["a"]);var Dt={apiKey:"AIzaSyAKDy8V2E8y2rAsQ4UfByQ2Q7nXkNdahBs",authDomain:"chatapp-fe0b0.firebaseapp.com",databaseURL:"https://chatapp-fe0b0.firebaseio.com",projectId:"chatapp-fe0b0",storageBucket:"chatapp-fe0b0.appspot.com",messagingSenderId:"927199564108",appId:"1:927199564108:web:b111e414b66dc8188d3fe9",measurementId:"G-K3NQPSTTV8"};l.a.initializeApp(Dt),new o["default"]({router:Lt,render:function(t){return t(b)}}).$mount("#app")},"6d1b":function(t,e,s){},"6fdb":function(t,e,s){"use strict";var o=s("1ba7"),a=s.n(o);a.a},7582:function(t,e,s){},"7dde":function(t,e,s){"use strict";var o=s("9fa4"),a=s.n(o);a.a},"85ec":function(t,e,s){},"920a":function(t,e,s){},"95ed":function(t,e,s){t.exports=s.p+"img/otter.15d74ef1.jpg"},"9fa4":function(t,e,s){},bf63:function(t,e,s){t.exports=s.p+"img/otter.15d74ef1.jpg"},c490:function(t,e,s){"use strict";var o=s("920a"),a=s.n(o);a.a}});
//# sourceMappingURL=app.c422af69.js.map